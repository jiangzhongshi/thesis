\section{Related Works}\label{cumin:sec:related}

We review the literature on the generation of unstructured and structured curved meshes. We also review the literature on boundary-preserving linear meshing, as it is an intermediate step of our algorithm.

\subsection{Curved Tetrahedral Mesh Generation}

High-order meshes are used in applications in graphics \cite{bargteil2014animation,MEZGER2009680,Suwelack2013} and engineering analysis \cite{Jameson2002} where it is important to reduce the geometric discretization error \cite{Babuska1988,BABUSKA1992159,BASSI1997251,luo2001influence,ODEN1994309}, while using a low number of degrees of freedom. The creation of high-order meshes is typically divided into three steps: (1) linear meshing of the smooth input surface, (2) curving of the linear elements to fit the surface, and (3) optimization to heal the elements inverted during curving. We first cover steps 2 and 3, and postpone the overview of linear tetrahedral algorithms to Section \ref{cumin:sec:rel:linear}.

\paragraph{Direct methods.} Direct methods are the simplest family of curving algorithms, as they explicitly interpolate a few points of the target curved surface or project the high-order nodes on the curved boundary  \cite{dey1999curvilinear,Ghasemi2016,MOXEY2015636,abgrall2012,sherwin2002mesh,turner2017high,marcon2019semi}. The curved elements are represented using Lagrange polynomials, \cite{dey1999curvilinear,Peir2008}, quadratic or cubic B{\'e}zier polynomials \cite{George2012,Qiukai2013,Luo2002pVersionMG}, or NURBS \cite{ENGVALL2016378,ENGVALL201783}. \cite{SHEPHARD2005251,sherwin2002mesh} further optimizes the high-order node distribution according to geometric quantities of interest, such as length, geodesic distance, and curvature. 
In the case where no CAD information is available, \cite{wang2016construction}, \cite{jiao2012reconstructing} use smooth reconstruction to compute high-order nodes and perform curving.

\paragraph{Deformation methods} Deformation methods consider the input linear mesh as a deformable, elastic body, and use controlled forces to deform it to fit the curved boundary. Different physical models have been employed such as linear, \cite{Abgrall2014,abgrall2012,dobrzynski2017,Xie2013}, and (variants of) non-linear elasticity \cite{Persson2009,MOXEY2016130,FORTUNATO20161}. A comparison between different elasticity and distortion energies is presented in \cite{Poya2016, TURNER2016340, dobrev2019target}.

Direct and deformation methods have been tested on small collections of simple models, and, to the best of our knowledge, none of them can provide guarantees on the validity of the output or has been tested on large collections of models. There are also no  reference implementations we could compare against. 

\paragraph{Inversions and Intersections.} Most of these methods introduce inverted elements during the curving of the high-order elements. Inverted elements can be identified by extending Jacobian metrics for linear elements \cite{Knupp20002,Knupp2000} to high-order ones \cite{Luke2018,Gargallo2014,johnen2013geometrical,Poya2016,Roca2012}. Various untangling strategies have been proposed, including geometric smoothing and connectivity modifications  \cite{Cardoze2004,dey1999curvilinear,gargallo2013high,George2012,Qiukai2013,Luo2002pVersionMG,Peir2008,SHEPHARD2005251,dobrzynski2017,Gargallo2015,Geuzaine2015,Roca2012,RUIZGIRONES2017362,RUIZGIRONES201652,RUIZGIRONES2016315,STEES2017180,Steve2016,TOULORGE20138,TOULORGE2016361,ZIEL201791,dobrev2019target, turner2017high, luo2008tracking,lu2014parallel}.  None of these techniques can guarantee to remove the inverted elements.

An alternative approach is to start from an inversion-free mesh and slowly deform it \cite{Persson2009,RUIZGIRONES2017362}, explicitly avoiding inversions at the cost of possibly inaccurate boundary reproductions. These methods cannot however guarantee that the boundary will not self-intersect. Our approach follows a similar approach but uses a geometric shell to ensure element validity and prevention of boundary self-intersections.

\paragraph{Curved Optimal Delaunay Triangulation}
\cite{feng2018curved} generalize optimal delaunay triangulation paradigm to the high-order setting, through iteratively update vertices and connectivity.
Their algorithm starts with a point cloud sampled from triangle meshes. However, the success of the method depends on the choice of final vertex number and sizing field, where insufficient vertices may result in broken topology or invalid tetrahedral meshes.

\paragraph{Software Implementation.}
Despite the large literature on curve{d} meshing generation, there are very few implementations available. 

Nektar~\cite{moxeynekmesh} is a finite element software with a meshing component, which can generate high-order elements. We do not explicitly compare as their documentation (Section 4.5.1.5 Mesh Correction\footnote{\url{https://doc.nektar.info/userguide/5.0.0/user-guidese17.html}}) states that the algorithm is not fully automatic and not designed to process robustly large collections of models.
Gmsh~\cite{Geuzaine:2009:gmsh} is an open source software that supports the curved meshing of CAD models, but it does not support dense linear meshes as input. Despite the difference in the input type, we provide a comparison with Gmsh in Section \ref{cumin:sec:comparison}, as it is the only method that we could run on a large collection of shapes.

To the best of our knowledge, the commercial software that support curved meshing (Pointwise \cite{pointwise,Steve2016}) are also requiring a CAD model as input.

\paragraph{Animation}
Curved tetrahedral meshes have also gained popularity in the context of fast animation. With fewer degrees of freedom and preserved geometric fidelity, 
\cite{mezger2007finite} observe the benefit of quadratic tetrahedra in the pipeline of physically based animation.
\cite{Suwelack2013} further investigate the transfer problem when using curved meshes as a proxy.

\subsection{Curved Structured Mesh Generation}

The use of a hexahedral mesh as a discretization for a volume, allows to naturally define $C^k$ splines over the domain, which can be used as basis functions for finite element methods: this idea has been pioneered by 
IsoGeometric Analyisis (IGA), and it is an active research area. The generation of volumetric, high-order parametrizations that conform to a given input geometry is an extremely challenging problem \cite{Sorger:2014,Peir2015OnCH}. Most of the existing methods rely on linear hexahedral mesh generation, which is on its own a really hard problem for which automatic and robust solutions to generate coarse meshes are still elusive \cite{Yufei:2012,Gao:2019,Guo2020Cut,Palmer:2020,Zhang:2020,marschner2020hexahedral} due to the inherently global nature of the problem. 
%
The current state of the art for IGA meshing is a combination of manual decomposition of the volume and semi-automated geometrical fitting \cite{yu2020hexgen,coreform}.

In contrast, our approach is automatic, i.e. can automatically process thousands of models without any manual intervention, while providing explicit guarantees on both the validity of the elements and the maximal geometric error. Its downside is the $C^0$ continuity of the basis on the elements' interfaces. However, it is unclear to us if this is a real limitation: in many common settings in computer graphics and mechanical engineering (Poisson problems, linear and non-linear elasticity) the higher smoothness offered by spline functions does not make noticeable difference experimentally \cite{schneider2019large} (and it actually leads to much worse conditioning of the system matrix, which is problematic for iterative solvers), and we thus believe that curved tetrahedral meshing is a very exciting alternative as it dramatically simplifies both the meshing and fitting of high-order elements.

\subsection{Boundary Preserving Tetrahedral Meshing}
\label{cumin:sec:rel:linear}

We refer to \cite{hu2018tetrahedral} for a detailed overview of linear tetrahedral meshing, and we focus here only on the techniques that target boundary preserving tetrahedral meshing. 

The most popular linear tetrahedral meshing methods are based on {\em Delaunay refinement}
\cite{chew1993guaranteed,shewchuk1998tetrahedral,ruppert1995delaunay}, i.e. the insertion of new vertices at the center of the circumscribed sphere of the worst
tetrahedron in term of radius-to-edge ratio. This approach is used in the most popular tetrahedral meshing implementations  \cite{tetgen,jamin2015cgalmesh}, and, in
our experiments, proved to be consistently successful as long as the boundary is allowed to be refined. A downside of these approaches is that a 3D Delaunay mesh, unlike the 2D case, might still contain ``sliver'' tetrahedra, thus requiring mesh improvement
heuristics \cite{cheng2000silver,du2003tetrahedral,alliez2005variational,tournois2009interleaving}. \cite{Alexa:2019} discusses this issue in detail and provides a different formulation to avoid it without the use of a postprocessing. 
%
\cite{alexa2020conforming} introduces an approach that does not allow insertion of Steiner points, making it not suitable for generic polyhedra domains.

There are many variants of {Delaunay-based} meshing algorithms including 
{\em Conforming Delaunay tetrahedralization}
\cite{murphy2001point,cohen2002conforming}, {\em constrained Delaunay tetrahedralization}
\cite{chew1989constrained,si2005meshing,shewchuk2002constrained,SiS14}, and {\em Restricted Delaunay tetrahedralization}\ \cite{cheng2008practical,boissonnat2005provably,Engwirda16}.

To the best of our knowledge, all these methods are designed to allow some modifications of the input surface (either refinement, resampling, or approximation). One exception is the constrained Delaunay implementation in TetGen \cite{si2015tetgen} that allows disabling any modification to the boundary. However, this comes at the cost of much lower quality and potential robustness issues, as we show in Appendix \ref{app:tetgen}. 

A different tetrahedral meshing approach has been proposed in \cite{hu2018tetrahedral}, and its variants \cite{Hu:2020:fTetWild,Hu:2019:triwild}, where the problem is relaxed to generate a mesh that is close to the input to increase robustness. However, these approaches are not directly usable in our setting, as we require boundary preservation.

Due to these issues, we propose a novel boundary-preserving tetrahedral meshing algorithm specifically tailored for the shell mesh generated by our curved meshing algorithm.

\subsection{Curved Surface Fitting}
There are many algorithms for fitting curved \emph{surfaces} to dense 3D triangle meshes. The most popular approaches fit spline patches, usually on top of a quadrangular grid. Since generating quadrilateral meshes is a challenging problem for which robust solutions do not exist yet, we refer to \cite{QUADSTAR2012} for an overview, and only review in this section algorithms for unstructured curve{d} mesh generation, which are more similar to our algorithm. We note that the focus of our paper is volumetric meshing: while we generate an intermediate curved surface mesh, this is not the goal of our algorithm, especially since the generated surface is only $C^0$ on edges.

\cite{hoppe1994piecewise} fits a smooth surface represented by a point cloud to a curved triangle mesh based on a subdivision surface scheme and an interleaving mesh simplification and fitting pipeline that preserves sharp features. 
The algorithm does not provide explicit correspondence to the input: they are defined using distance closest point, which is not bijective far from the surface. 

\cite{krishnamurthy1996fitting} converts dense irregular polygon meshes of arbitrary topology into coarse tensor product B-spline surface patches with accompanying displacement maps. Based on the work \cite{LIN2007adap} that fits triangle surface meshes with B\'ezier patches, \cite{Zhang2011multi} fits triangle surface meshes with high-order B-spline quadrilateral patches and adaptively subdivide the patches to reduce the fitting error. These methods produce smooth surfaces but do not have feature preservation.

Another related topic is the definition of smooth parametric surfaces interpolating triangle meshes. We refer to \cite{zorin2000subdivision} for an overview of subdivision methods and discuss here the approaches closer to our contribution.

\cite{Hahmann2003} proposed to use triangular B\'ezier patches to define smooth surfaces over arbitrary triangle meshes ensuring tangent plane continuity by relaxing the constraint of the first derivatives at the input vertices.
%
Following Hahmann's work, \cite{yvart2005smooth} presents a more complete pipeline: perform QEM simplifications, trace the coarse mesh onto the dense one and perform parameterization relaxing and smoothing. Then it fits a hierarchical triangular spline~\cite{Yvart2005hier} to the surface.
%
More recent work \cite{TONG2009} approximates the triangulation of an implicit surface with a $G^1$ surface.
%
These schemes are usually designed to interpolate existing meshes rather than simplifying a dense linear mesh into a coarse curved mesh and are thus orthogonal to our contribution.

% \cite{losasso2003smooth} Smooth geometry images. quad mesh?

% \url{https://www.graphics.rwth-aachen.de/media/papers/campen_siggraph2017_Similarity-T-Splines.pdf}

% \TODO{better to change gmsh paper to: The Generation of Valid Curvilinear Meshes}
